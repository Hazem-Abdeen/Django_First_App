{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Home</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <link rel="stylesheet" href="{% static 'store/css/home.css' %}">
  <link rel="stylesheet" href="{% static 'store/css/navbar.css' %}">
</head>

<body>
{% include "store/navbar.html" %}

<!-- HERO -->
<section class="hero">

  <!-- Filters LEFT inside HERO (Abdeen stays centered) -->
  <aside class="hero-filters">
    <div class="filter-card">
      <h5>Filters</h5>

      <form method="get">
        <input type="hidden" name="q" value="{{ selected.q }}">

        <!-- Accordion -->
        <div class="accordion lux-accordion" id="filtersAccordion">

          <!-- Brand -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingBrand">
              <button class="accordion-button" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseBrand"
                      aria-expanded="true" aria-controls="collapseBrand">
                Brand
              </button>
            </h2>

            <div id="collapseBrand" class="accordion-collapse collapse show"
                 aria-labelledby="headingBrand" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">

                {% for b in brands %}
                  <label class="filter-option">
                    <input type="checkbox" name="brand" value="{{ b.id }}"
                           {% if b.id|stringformat:"s" in selected.brand %}checked{% endif %}>
                    <span>{{ b.name }}</span>
                  </label>
                {% empty %}
                  <div class="text-secondary small">No brands</div>
                {% endfor %}

              </div>
            </div>
          </div>

          <!-- Gender -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingGender">
              <button class="accordion-button collapsed" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseGender"
                      aria-expanded="false" aria-controls="collapseGender">
                Gender
              </button>
            </h2>

            <div id="collapseGender" class="accordion-collapse collapse"
                 aria-labelledby="headingGender" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">

                <label class="filter-option">
                  <input type="checkbox" name="gender" value="men"
                         {% if "men" in selected.gender %}checked{% endif %}>
                  <span>Men</span>
                </label>

                <label class="filter-option">
                  <input type="checkbox" name="gender" value="women"
                         {% if "women" in selected.gender %}checked{% endif %}>
                  <span>Women</span>
                </label>

                <label class="filter-option">
                  <input type="checkbox" name="gender" value="unisex"
                         {% if "unisex" in selected.gender %}checked{% endif %}>
                  <span>Unisex</span>
                </label>

              </div>
            </div>
          </div>

          <!-- Price -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingPrice">
              <button class="accordion-button collapsed" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapsePrice"
                      aria-expanded="false" aria-controls="collapsePrice">
                Price
              </button>
            </h2>

            <div id="collapsePrice" class="accordion-collapse collapse"
                 aria-labelledby="headingPrice" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">
                <div class="d-flex gap-2">
                  <input class="filter-input" type="number" step="0.01"
                         name="min_price" placeholder="Min" value="{{ selected.min_price }}">
                  <input class="filter-input" type="number" step="0.01"
                         name="max_price" placeholder="Max" value="{{ selected.max_price }}">
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="d-grid gap-2 mt-3">
          <button class="btn btn-gold w-100" type="submit">Apply</button>
          <a class="btn btn-outline-lux w-100" href="{% url 'home' %}">Reset</a>
        </div>
      </form>

    </div>
  </aside>

  <!-- Center hero -->
  <div class="hero-content">
    <div class="eyebrow">Swiss Engineering • Est 1924</div>
    <h1>Abdeen<br/>Watches</h1>
    <p>
      Crafting mechanical masterpieces for those who value the art of time.
      Discover our latest collection of refined designs.
    </p>
    <div class="d-flex gap-3 justify-content-center flex-wrap">
      <a class="btn btn-gold" href="#collection">Explore Collection</a>
      <a class="btn btn-outline-lux" href="#">Our Heritage</a>
    </div>
  </div>
</section>

<!-- COLLECTION -->
<section id="collection" class="section">
  <div class="container">
    <div class="d-flex align-items-end justify-content-between flex-wrap gap-3 mb-3">
      <div>
        <div class="section-title">Curated Selection</div>
        <h2 class="m-0">The Masterpiece Collection</h2>
      </div>
      <a class="btn btn-outline-lux" href="#">View all timepieces</a>
    </div>

    <div class="row g-4">
      {% for product in products %}
        <div class="col-md-6 col-xl-4">
          <div class="lux-card position-relative">
            <span class="tag">
              {% if forloop.first %}Best Seller
              {% elif forloop.counter == 2 %}New Arrival
              {% else %}Limited Edition
              {% endif %}
            </span>

            <div class="lux-media">
              {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.title }}">
              {% else %}
                <img src="{% static 'store/img/placeholder.png' %}" alt="No image">
              {% endif %}
            </div>

            <div class="lux-body">
              <div class="d-flex justify-content-between align-items-start gap-2">
                <div class="lux-title">{{ product.title }}</div>
                <div class="price">${{ product.unit_price }}</div>
              </div>

              <div class="lux-sub">
                {{ product.description|default:""|truncatechars:60 }}
              </div>

              <div class="mt-3">
                <a class="btn btn-outline-lux w-100" href="{% url 'product-detail' product.id %}">
                  View details
                </a>
              </div>
            </div>

          </div>
        </div>
      {% empty %}
        <p class="text-secondary">No products yet.</p>
      {% endfor %}
    </div>
  </div>
</section>

<div class="divider"></div>

<footer class="py-4">
  <div class="container d-flex justify-content-between flex-wrap gap-2">
    <div class="text-secondary">© {{ now|date:"Y" }} CHRONOS</div>
    <div class="text-secondary">Crafted with care.</div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>